/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,t,n){e.exports=n.p+"e91802e100da6c18ad04.css"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var c=t[r]={exports:{}};return e[r](c,c.exports,n),c.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?t(Object(o),!0).forEach(function(t){r(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function r(t,n,r){return(n=function(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function o(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function a(n,r,o,i){var a=r&&r.prototype instanceof l?r:l,s=Object.create(a.prototype);return c(s,"_invoke",function(n,r,o){var c,i,a,l=0,s=o||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return c=t,i=0,a=e,d.n=n,u}};function p(n,r){for(i=n,a=r,t=0;!f&&l&&!o&&t<s.length;t++){var o,c=s[t],p=d.p,y=c[2];n>3?(o=y===r)&&(a=c[(i=c[4])?5:(i=3,3)],c[4]=c[5]=e):c[0]<=p&&((o=n<2&&p<c[1])?(i=0,d.v=r,d.n=c[1]):p<y&&(o=n<3||c[0]>r||r>y)&&(c[4]=n,c[5]=r,d.n=y,i=0))}if(o||n>1)return u;throw f=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,y),i=s,a=y;(t=i<2?e:a)||!f;){c||(i?i<3?(i>1&&(d.n=-1),p(i,a)):d.n=a:d.v=a);try{if(l=2,c){if(i||(o="next"),t=c[o]){if(!(t=t.call(c,a)))throw TypeError("iterator result is not an object");if(!t.done)return t;a=t.value,i<2&&(i=0)}else 1===i&&(t=c.return)&&t.call(c),i<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),i=1);c=e}else if((t=(f=d.n<0)?a:n.call(r,d))!==u)break}catch(t){c=e,i=1,a=t}finally{l=1}}return{value:t,done:f}}}(n,o,i),!0),s}var u={};function l(){}function s(){}function f(){}t=Object.getPrototypeOf;var d=[][r]?t(t([][r]())):(c(t={},r,function(){return this}),t),p=f.prototype=l.prototype=Object.create(d);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,i,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=f,c(p,"constructor",f),c(f,"constructor",s),s.displayName="GeneratorFunction",c(f,i,"GeneratorFunction"),c(p),c(p,i,"Generator"),c(p,r,function(){return this}),c(p,"toString",function(){return"[object Generator]"}),(o=function(){return{w:a,m:y}})()}function c(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}c=function(e,t,n,r){function i(t,n){c(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},c(e,t,n,r)}function i(e,t,n,r,o,c,i){try{var a=e[c](i),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function a(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var c=e.apply(t,n);function a(e){i(c,r,o,a,u,"next",e)}function u(e){i(c,r,o,a,u,"throw",e)}a(void 0)})}}function u(e){return l.apply(this,arguments)}function l(){return(l=a(o().m(function e(t){var n;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return document.getElementById("popup-overlay").style.display="none",O("Daten werden gesendet..."),e.p=1,e.n=2,fetch("https://192.168.31.180:8432/import",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:e.v.ok?(document.getElementById("loading-state").style.display="none",document.getElementById("popup-overlay").style.display="none",document.getElementById("display-result-container").style.display="none",document.getElementById("options").style.display="none",document.getElementById("transfer-successful").style.display="flex"):B("Fehler beim Senden der Daten,"),e.n=4;break;case 3:e.p=3,n=e.v,console.error("Failed to send data:",n),B("Fehler beim Senden der Daten,");case 4:return e.a(2)}},e,null,[[1,3]])}))).apply(this,arguments)}function s(e){return f.apply(this,arguments)}function f(){return(f=a(o().m(function e(t){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,new Promise(function(e,n){t.body.getAsync(Office.CoercionType.Text,function(t){t.status===Office.AsyncResultStatus.Succeeded?e(t.value):n(t.error)})});case 1:return e.a(2,e.v)}},e)}))).apply(this,arguments)}function d(e){return p.apply(this,arguments)}function p(){return(p=a(o().m(function e(t){var n;return o().w(function(e){for(;;)switch(e.n){case 0:return n=t.attachments.map(function(e){return new Promise(function(n){t.getAttachmentContentAsync(e.id,function(t){n({name:e.name,id:e.id,contentType:e.contentType,contentBytes:t.value.content})})})}),e.n=1,Promise.all(n);case 1:return e.a(2,e.v)}},e)}))).apply(this,arguments)}function y(e){return m.apply(this,arguments)}function m(){return(m=a(o().m(function e(t){var r;return o().w(function(e){for(;;)if(0===e.n)return console.log("Button clicked"),r=t.map(function(e){return e.Belegtext?n(n({},e),{},{Belegtext:e.Belegtext.replace(/Best\..*vom/,"Angebot vom")}):n({},e)}),document.getElementById("popup-overlay").style.display="flex",e.a(2,{type:"offer",df:r})},e)}))).apply(this,arguments)}function g(e){return h.apply(this,arguments)}function h(){return(h=a(o().m(function e(t){return o().w(function(e){for(;;)if(0===e.n)return console.log("Button clicked"),document.getElementById("popup-overlay").style.display="flex",e.a(2,{type:"order",df:t.map(function(e){return e})})},e)}))).apply(this,arguments)}function b(){document.getElementById("popup-overlay").style.display="none"}function v(e){var t=document.getElementById("header-row"),n=document.getElementById("table-body"),r=["Pos","Artikelnummer","Menge"];r.forEach(function(e){var n=document.createElement("th");n.textContent=e,t.appendChild(n)}),e.forEach(function(e){var t=document.createElement("tr");r.forEach(function(n){var r=document.createElement("td");r.textContent=e[n],t.appendChild(r)}),n.appendChild(t)})}function E(e){document.getElementById("customer-number-container").innerHTML="<span><strong>Kdnr:</strong> ".concat(e[0].Kundennummer,"</span>"),document.getElementById("introduction-text-container").innerHTML="<span><strong>Text:</strong></span><br><span>".concat(e[0].Belegtext,"</span>");var t=document.getElementById("reference-text-container");e[0].Referenz&&(t.innerHTML="<span><strong>Referenz: </strong></span> ".concat(e[0].Referenz)),document.getElementById("delivery-address-container").innerHTML='<span><strong>Lieferadresse:</strong></span>\n<address class="address-box">\n'.concat(e[0].Name1,"<br>\n").concat(e[0].Strasse,"<br>\n").concat(e[0].PLZ," ").concat(e[0].Ort,"\n")}function w(){var e=document.getElementById("display-result-container"),t=document.getElementById("loading-state"),n=document.getElementById("loading-error");t.style.display="none",e.style.display="block",n.style.display="none"}function O(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"loading",t=document.getElementById("display-result-container"),n=document.getElementById("loading-state"),r=document.getElementById("loading-error"),o=document.getElementById("loading-text");document.getElementById("options").style.display="none",n.style.display="flex",t.style.display="none",r.style.display="none",o.innerHTML=e}function B(e){var t=document.getElementById("loading-error"),n=document.getElementById("display-result-container"),r=document.getElementById("loading-state"),o=document.getElementById("options");document.getElementById("popup-overlay").style.display="none",o.style.display="none",r.style.display="none",n.style.display="none",t.style.display="block",t.innerHTML="<p>".concat(e,"</p>")}function I(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function c(n,r,o,c){var u=r&&r.prototype instanceof a?r:a,l=Object.create(u.prototype);return j(l,"_invoke",function(n,r,o){var c,a,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return c=t,a=0,u=e,d.n=n,i}};function p(n,r){for(a=n,u=r,t=0;!f&&l&&!o&&t<s.length;t++){var o,c=s[t],p=d.p,y=c[2];n>3?(o=y===r)&&(u=c[(a=c[4])?5:(a=3,3)],c[4]=c[5]=e):c[0]<=p&&((o=n<2&&p<c[1])?(a=0,d.v=r,d.n=c[1]):p<y&&(o=n<3||c[0]>r||r>y)&&(c[4]=n,c[5]=r,d.n=y,a=0))}if(o||n>1)return i;throw f=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,y),a=s,u=y;(t=a<2?e:u)||!f;){c||(a?a<3?(a>1&&(d.n=-1),p(a,u)):d.n=u:d.v=u);try{if(l=2,c){if(a||(o="next"),t=c[o]){if(!(t=t.call(c,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,a<2&&(a=0)}else 1===a&&(t=c.return)&&t.call(c),a<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),a=1);c=e}else if((t=(f=d.n<0)?u:n.call(r,d))!==i)break}catch(t){c=e,a=1,u=t}finally{l=1}}return{value:t,done:f}}}(n,o,c),!0),l}var i={};function a(){}function u(){}function l(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(j(t={},r,function(){return this}),t),f=l.prototype=a.prototype=Object.create(s);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,j(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=l,j(f,"constructor",l),j(l,"constructor",u),u.displayName="GeneratorFunction",j(l,o,"GeneratorFunction"),j(f),j(f,o,"Generator"),j(f,r,function(){return this}),j(f,"toString",function(){return"[object Generator]"}),(I=function(){return{w:c,m:d}})()}function j(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}j=function(e,t,n,r){function c(t,n){j(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(c("next",0),c("throw",1),c("return",2))},j(e,t,n,r)}function T(e,t,n,r,o,c,i){try{var a=e[c](i),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function x(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var c=e.apply(t,n);function i(e){T(c,r,o,i,a,"next",e)}function a(e){T(c,r,o,i,a,"throw",e)}i(void 0)})}}function S(){return P.apply(this,arguments)}function P(){return(P=x(I().m(function e(){var t,n,r,o,c,i,a,u,l,f,p,y;return I().w(function(e){for(;;)switch(e.p=e.n){case 0:return O("Daten werden geladen..."),t=Office.context.mailbox.item,n=document.getElementById("header-row"),r=document.getElementById("table-body"),n.innerHTML="",r.innerHTML="",e.n=1,s(t);case 1:return o=e.v,e.n=2,d(t);case 2:return c=e.v,i=document.querySelectorAll(".attachment-checkbox:checked"),a=document.getElementById("include-subject"),u=document.getElementById("include-body"),l={subject:a.checked?t.subject:null,body:u.checked?o:null,attachments:[]},i.forEach(function(e){var t=c.find(function(t){return t.id===e.id});l.attachments.push(t)}),e.p=3,e.n=4,fetch("https://192.168.31.180:8432/analyse_email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});case 4:return f=e.v,e.n=5,f.json();case 5:if((p=e.v).df&&0!==p.df.length){e.n=6;break}return B("Keine Artikel gefunden in Bestellung gefunden"),e.a(2);case 6:v(p.df),E(p.df),w(),p.df,document.getElementById("options").style.display="flex",console.log("Success",p.df),e.n=8;break;case 7:e.p=7,y=e.v,B("Fehler beim Laden der Daten."),console.log("Error:",y);case 8:return e.a(2)}},e,null,[[3,7]])}))).apply(this,arguments)}Office.onReady(function(){var e=x(I().m(function e(t){var n,r,o,c;return I().w(function(e){for(;;)switch(e.n){case 0:if(t.host!==Office.HostType.Outlook){e.n=2;break}return console.log("ready"),n=[],r={type:"",df:[]},document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("run").onclick=S,document.getElementById("send-offer-to-api").onclick=x(I().m(function e(){return I().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,y(n);case 1:r=e.v;case 2:return e.a(2)}},e)})),document.getElementById("send-order-to-api").onclick=x(I().m(function e(){return I().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,g(n);case 1:r=e.v;case 2:return e.a(2)}},e)})),document.getElementById("confirm-no").onclick=b,document.getElementById("confirm-yes").onclick=function(){u(r)},o=Office.context.mailbox.item,c=document.getElementById("attachment-list"),e.n=1,d(o);case 1:e.v.forEach(function(e){"application/pdf"!=e.contentType&&"application/x-pdf"!=e.contentType||(c.innerHTML+='\n          <div class="selection-item">\n              <input type="checkbox" id='.concat(e.id,' class="attachment-checkbox" checked>\n              <label for = ').concat(e.id,">").concat(e.name,"</label>\n          </div>\n        "))});case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}())}(),new URL(n(58394),n.b)}();
//# sourceMappingURL=taskpane.js.map